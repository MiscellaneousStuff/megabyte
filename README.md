# Meta MegaByte

## About

Meta MegaByte model experiments. \
Based on [MEGABYTE-pytorch](https://github.com/lucidrains/MEGABYTE-pytorch) 
repository from Lucidrains and [nanoGPT](https://github.com/karpathy/nanoGPT)
from Andrej Karpathy.

All training runs available publicly on [Neptune.ai](https://app.neptune.ai/miscellaneousstuff/megabyte-training/).

## TODO

- [x] Create training script
   - [x] Add Neptune.ai logging
   - [x] Add cosine learning rate scheduler
   - [x] Add weight initialisation based on MegaByte paper

## Experiments

- [x] Baseline Lucidrains plus Cosine LR (Neptune: [MEG-16](https://app.neptune.ai/miscellaneousstuff/megabyte-training/runs/details?viewId=standard-view&detailsTab=charts&shortId=MEG-16&type=run))
   - [x] More or less the same as no LR schedule. Very slightly worse. 
- [x] Baseline Lucidrains plus Cosine LR using AMP (Neptune: [MEG-21](https://app.neptune.ai/miscellaneousstuff/megabyte-training/runs/details?viewId=standard-view&detailsTab=charts&shortId=MEG-21&type=run))
- [x] Double Batch Size from 4 to 8 (Effective 16 to 32)
   - [x] Naive Attempt: Slightly worse convergence (Neptune: [MEG-18](https://app.neptune.ai/miscellaneousstuff/megabyte-training/runs/details?viewId=standard-view&detailsTab=charts&shortId=MEG-18&type=run))
 - [x] LR (6e-4 to 6e-5):
    - [x] (BS := 8, Neptune: [MEG-19](https://app.neptune.ai/miscellaneousstuff/megabyte-training/runs/details?viewId=standard-view&detailsTab=charts&shortId=MEG-19&type=run)) Faster and better convergence per training step.
          However, validation loss vs wall-clock time is worse, clear trade-off.
    - [x] (BS := 4, Neptune: [MEG-20](https://app.neptune.ai/miscellaneousstuff/megabyte-training/runs/details?viewId=standard-view&detailsTab=charts&shortId=MEG-20&type=run)) Learning rate too high for this batch size. Training loss plateaus then gets worse, validation loss stays the same.

## Pre-Trained Models

- `megabyte_25k_1.2836014032363892.pt`
  MegaByte model trained on enwik8 for 25k batches (~36.44x passes over the dataset).
  Produces text as seen below. Model is starting to correctly spell words,
  learning n-gram 2/3 sequences, etc. Is continuing to converge. Trained for just
  over 12 hours on RTX 3060 Ti. (Full convergence on RTX 3060 Ti would take roughly
  50 hours). Final validation loss is ~1.28 with a perplexity of 3.59.

## Training

### After 25k epochs (Roughly 10 epochs of enwik8)

Validation loss: 1.2836014032363892

<details><summary>Prompt: "hi"</summary>
Response: a confusion, an influence onew [[progressionative]] spanning, opponents of and free of a horistian claim of pages, and [[bategory]] forms oference during the [[15 years]] and the most expe color increaseduced to its promain of the early theory became org.throughout the work, women an as other titles of women, but ctive, professor the publication, the papers makes.  After a nearom offering impof him to testimobase, a publishe>  1295, exclurisments and pubol==The followas trends later              <ustark production to the &quot;fachel supposing's index&quot;.  She label can be arcus of question towards the path=420 years in there are differer]], but it is sh; removing ''a&gt;, the first rmer '''a galfe' the latest times for set to forman readership.  of [[Scotland]] about 17% to oveek half 100. Undy Paris.  The of Albert Egencyed as a letter who started him, the end of the ctic system was oldoven.  (Both ra developed to berlindung in Chis created by the cage and wrote and the encyclus listed been datiful for severaloss companies).*Femaley in 196974]], Bran expladapted for over    </revision> Taken by the Engue]], allegedly a special officesh developed onle=&quot;palm thed with record oranssend of adverom temporary andam]],&quot; ''Deasile Blewer'', the later died if the ran to sucompus the ''Gellt;br&gt; Columbus (resource)'' ing at the Universtanding School.com/Long-Centre prior explosion, this academie r [[selenzymal]] more provisions, the [[Wiremigramp>  Examples]]]&lt;/cite&gt; o compensation, t from the [[15704.77]] (2005) anists as or ''saroni mittoj'' it water there orgace.]]==A.C. (1995)==&lt;font Sebid=&quot;freer skylows&quot; [[Schwayz-cheeckland]]: &quot;&lden and mindward form of regular&quot; &amp;mdas]].This term d against Alsenhorg/ ''B. Jean Wopean, Jun Tive. cleanwieling,'' occupies Unix-Pr episodes 02.66*[http://www.usan philers.org/htar'' &quot;Documatic Tree&quot;, while scandal components]: Biow.documentation, when only monitords sport. In 1990, the decisional level of thiny [[requested positioning]] (''casual evidence''' (Alvating)Theglecture uprighto laws) concerns (say them the cumenical mushlete Courts of SCSII of the [[Oscaregister concentr. In Mac Octob|Such region]], [[http://www.ycddbuild.co.uk/tc/1/ Dalth Design] aligoed &quot;Faty, scripts untilam_scholars=&quon, printed 2-maine]], urban d, ctionary.===Ref design subcompist of copyright and eye style=====Examples of Ed pseudo: DBLA crscopes of the prs.png|feat===Washington minisental neuron and fortification ofit of the group [[Exxxxia]] is aries.Dr. Cereby and Furrender intended expandepcia's eyeculare publicity. Ithe then-progress censuses classesecond and Carnon II had receiveleased eternal ibutors to [[publy occurring of ctic]] in [[Mexics of MiddleOner]], and was givents]] by other [[precorrelations] features, all-re had providing The [[selective </partisan|publitude]] 10%.  Nevisions, overests. This practicelluting from elecompassed the prean [[100]] and f the two memberst.com enlist indely provide coalties, while teched in progressivened, supplier, of text track, a map of accountark]).==Improvitle>           was a small poig its advance&lt; showing at once mind.&lt;/cental id=0 [[Taxon by Reference]] </revision--nr. the tripod is non an abhtMW in ts copies it withitecture's diffesare superscalaress forms longerong. (In the lashock of prefix sswip, for examplirt of less a fas ''wan'' operation of a century on land, &quot;#363&amp;nbsp;ttion,_3&quot; whem as lineage is to other differel work.)== Coled &quot;diamond theoretics&quoty]], the paragral program must ith Data Store anal enough even m)]]===Links torg/free support ported life analus releases===Ancient Egyptoft developed the aboke song rare. Operand ''[[Doiny sempling]]'' arporates a languattle standard cansformation at [[Noun Region of caroon]], [[Neurate Unwardst]], to [[December 102-03|20]], and mestate ''Request of Mechanists''The come on modeak at the end of All Giant, and spirits of the nstricted virtualex/citration witer while monitoreases. The evenightly launched world to hold higles as 'transmit and media, in alisation of majon]], and all as T. Wavarier musigling in his oldeo Generalism by of teaching won [[Julian Earthquot;]] was a memling of story ince''each propul food in 1923, iverses the casinniu--physical enics, purchased ble in system, thony] and publicuesting for this was as [[African control]]ing mash; albert parklude on the [[F.    = 2010 countreduction for a l entire]] termin ratio of the fions of light. Reviations have a in part for a fel Skate labor, [Crisis of Conser related words]]], A. Abbergne ise transfer to t (mariteme event the more work ode from the trant of a time) cope|circumcision war to Experimentiveness and the of the argument [[Astronomical]] seven still mory of the country. Christian comm of drum states Castle was estimmunicated by wom]];* The [[Revo identity (Europort in ethics)|d ship propriety]]'s Clarke. The hydrogen articled in front of thomson. Although words workers us in the early imarked to read the flight, those was one who signd on the middle ancient writer ive.# In the cas &quot;coprocean theory&quot; ex|Ammotion Christations have atted to four eight that different moon) is not glucould, at which a telephone movema, this first has, 1.2 occupied differ in percepute age 21 and 1&lt;sup&gt;th&ltion boars is cery bar, i.e. the  <comment>/worrion of an early st of the Earth. to spacecraft al god-racing absor at a simple an [[Transcription system]].The in [[thrump]] by, and appears innelled by one ofor sense that st;Butle separatedent was capable to the traditionsexual relations Cross.  Ciable and past overheansgender abuse p://online.some of all the logo (particle) of poor liquids, or ther sites, meaninnares and gay ints into run oil [[Siktionary:Maut extraordinary point]] need notavaria.&lt;!-- Indigivida viewpot;sucleic actualistic, making code&gt;303,000,903-03-1015  ancestone developed urkmunds. CDS by was multi-points]], and one has a dead caused ition is backward---* ''The [[Prerosigns of Greest, cleopasses byssions]]'' &amp;/subscription (d in [[Literaturn action|allegorideois]] by [[Priors are progressiv]], 2003)*&qut/18472-861.1558 || '''Personingle Insulations''s expense on ther, three-third s are strongly fr African undulat areas in Indepento] by the UN ime affairs:* A [[National Linkismance Constitunded Aerospace|la (letter-span)|2005]]; a campaious synonymous within the IV of free visitors (as enki) cadezoa.)*The ''Sen'' [[1898]] (appearstion may the arthey also resulte]], [[Durienter in [[Coloridatiorld]] and the [[France#Foundatio slang nations|stamp terror]]s, larger [[Specialuding moon]]s; theoning person,  The deviation, are useful to ext xml: &quot;Int;/TAD&quot;, in recommendal; thecomes created ased ago of scale    <id>704255111972], which is rologised at low step in specificompositions:* the '''Metropolician Point for Replacement''': '''[[Ante agent|Notes]]''' (one mage: that is tecommendation of t]].  '''The frem. Hard Aberiesth a progressive (1988):''' [httpreversion.lin.tin it.leburg-stephy]]* [[Ecology]] [http://www.cond set.org] thea of is more par by the [[Parsonealogy]] school mind, which was systematically an American neolof Brassing volump;gravity movemen the calculatio briefs of its p;&lt;span style===&lt;code0;nonomicalline&gt;ostric education of the French &as.)* [[Rinalecthe [[Pizara]] (External links).* Window Walkestance polycholas'' or ''&quot;Interaction One Comic]&quot;'' rep;|-*[[Dword slation]] ([[187704,460 season]]) for a significacilization of Acompetitivative conference in [[eringquest]]* [[[pseudahygian]]             .* information for on [[animal]]: ctions also incluot; ([[help skeprogram]] linkwisorghones from [[Snatz]], [[Tuanes, wars|Subsequer thesis]])* [[[epischer]] (seesemblance among Adell System, clso hallow chauce]] in the early of comments up while the assembl spectrum [[Camb] ([[Glam Historonment|Stage]]) cognate with [[Roman and Studie
</details>

<details><summary>
Prompt: Machine learning [[Algorithm|algorithms]] build a model based on sample data, known as [[training data]], in order to make predictions or decisions without being explicitly programmed to do so.</summary>
Response: two volumes including [[Triporation]]s.  The:GIG not home verence: ''b. moleactive'', the land as sphere as sidese defence. his removal on at it: still is d the third or eve (social work, for prenatory), this ''sprrsituralitare'' (whical engines of es, rood's diamoning, beginning instance)==Refes]], [http://newidesc.edu/europet's Diah Kebby]&lt;!-- Presenter]]{{crediblersion}}{{Africath&gt; Influence School of Englith the British IRECT}}{{The Fibert]]* ''Commonternite Green dineering Backgroultra'' [http://ws the l.org.uk/h (iblic education theory])* [[John Lake Punk]]   <title=Dnd Prinusa (''[http://www.bankline.inf episode, see a Spain and Perfecail]'')* [[Herment.]] ''(San Ed promotive by Ancil Meriton or Greek'')== Intent==Calmerie de]][[Image:Abray tree.jpg|thumb|Papparid view ofied maps]]A fome with a variethe technician aressopoe. [[Cap afterlift in adoes meeting]] whus a film in sinchy]* [[Funk mor musical enginer theory]]* [[M Also transportamp>2]]    ''[[Magyars (drivery):''Damages]]'''  In many [[C+F_Dianety]]# &quoted to hearst any Classical tool a circlus and ale to its old one now&quot; - Por as well as in to the pupper, [[Ilame Marital Asia]]; there are colorfuse ancestters with oil intophesia; harmonow the steps arer), and can onlystem location annel it separatesince picture.* and dexterature largest tuddy (of which is [[Brir name|ED]]). Wipments regard the Babylon 7, fourgeographed drugrowth of [[Unive [[French Office computer prize|Mainted's unpublingual display]]]</text>    </rting  </commene collage sity ts an ''addition'' - together in istone.* [[Lised operator]]* who workshaped the [[Wychman]] (IEC])* [[Statifrom Light Instrulture Informatiombusation|NTAM]] of the Televisization measuremer, the [[C fan ative (Granite corerun)]], largelege] and other [[Chesto]] and itius [[around 20000 psychonomy|mur history of cres the panels]].In [[database]][[latin alphabegislation]] cons that keep [[streplioar case]]. abowever the topan&quot; are cometa left.[http:Anglepredeath.phad a type.net a [[Romeone from tains]] named A tic P newsleave. the modern modalso belong to thef&gt;[http://wwwlingled.org.uk/ really-verse, album)] condectiono'', [[John Sung'') occupies]]*{{cite web | id array of the tuld be a '''the c greater'''  a thema, lead  | was a unicary hest, 1 Showhile of the area! s:Corrent used *[[Grutal]]|}    &lt;td&gt;And thorough(gottonal tarter) = adu]] &lt;font comic purposes&gt;{{CDCAE width}} Books are abouts in ''ASU'' gam. [[EBMI]] is al-pounds have var seen variants ough that, namely don't like sameen to develop a meteorite* Therevision name (atasks, many compuot;. However, thead microwave re troublesome enc processing pictheir into an into]]s, but only al crafts properthan e-mail is in to which while (Australia repreporting takes)/ho want links to of [[Escape Filmay language|Earl itself]].  It s'' (marked), or [[Chord]]s' clus''* &quot;His &lt;tt&gt;I co abrought about &ltime of the art o useful.&quot;&gt;\ru, &quot;[&amp;auphryon&quom/fans en gupy ultipately don't [[Night]], Audirace.&quot;{{ref| name |  Things of Aberdeen Posconia, A Satelling big Point, Am/becky, Invader Allen and Warnerison | fullearnets = 2006 | pustry       = ISBiography | Page that is = 1973[[Image:Amfrosflly result off.pnfall.png|thumb|ribes|Adi Free (sh; only tocal pa crank])The opology mysteries make it family a]][[Image:Lab DanishB RALL.jpg|Arthurn maintainius under a lamp&quot;|==Compart, activities sports, sketcomeries==* '''BBCarip, set in Ant control Talk:''' (corrective mial need to speed exposure and scontribution to t;chronic guitar) and recall to uel of the specif the use of infor collected aboved tables (inclutor>     The Malso include the a slate level.#########   &quotock or &quot; itrip&quot;# Davie was the formeracce rather in tude's design* [[Dec Way Movemend of Hooler]], [http://www.instith alleriance.ordered on testifikitation directoncern]]# 'STP in the specific s simplest listinology==Litestite]* [[Braterhommendarian]] (dent as &quot;the clean and genesis]], [[London Dago.com]]) containce but &quot;Thave one of the only public country/earliest aspeen-atheism,&quotory made it her it is characterikine?) as oppose in memory, but to promote a pluzed genital curs is referred as of earlier voiced by its originatics to the shell and financial.  This is a linki&gt;{{ref|combural]}}  * [[Adbionomer (among my officient orgencing abbreviatinflumberences|Coon discontant a overlash, epistst, termination)]]</text>    </r and expected wing those who vier]]* &quot;In by a backyone cant of a car choon someone should>     the weekn of a synchronize as well.==Otributed and very:Original compong the illustratigher==When BASevere the adventhe linguistics t tell to the Bibrary of Arts, On]], Americanus presented a very such company foumbers, meaning tion|original coil]] officials inter]erlines. Soment] would benefictive and expering a current vata B--which centhe may also onceople enthrone eville how the norence from new mundering a handfuot; The locationd [[September]] refused to turn their digitists of command for py|alliance stillectors' sales, revised with the makeships never and linked stepsideries such as major confidencere and taxes actitled to promineads nominally crm &amp;mdash; winentonions like for matche synthould rooting [[ce opentene]]es imestering that cian like crafter]], including te thirty-over thed amendments wit of some of the <id>2886400 and of CABC had a tolder data of Cain the main-uploy:Sister Cities.A series of majols will survive pplioders gain ty offers proceed in the expansiof Blitzgeral powith the developmilies and frequects typically iman more developir]]s others fromorphic meanings..]]The UK Collement department the vicibal tim temporum sold ww.meat-trade und in the whalf and most of the trious strengths le Mesoling levelime|motivations:April 1950s, cauot;like drag of the population k:16Z (around 4 as to works for ppointership in mp>202), while in substantive teriginally helped it even in acadered more vehicled as such.Whil moouting work implyed that thisp;&amp;rdquo; red in small develar pen documentsever details devision results iny traffic from riani monopolis. of CH circumstan 1999 partner agn Adjacent [[Natty and Glmssen]] [[Fred And Issuente Institute f the Apollo|Natis the Nature Radetering], compled activist, or fectionism. Howeven the books are installed with companiets most pilots, such as if the televisiorg/popular theatend like [[Billsing disk bass]].He expanded thilbert stereosyspects of Commercceed sky, alphaby a major leakerinks, although Baka pop companiessability with mallets, defendindreing popular ment parts comes sort, but let tould not be consing there or in [Norse China to pany|Carl]] and conclude. Bubble of a threating is &quot;the can a funeral of theen text filed wia]] [[Economic arily]] movement to [[Austrian Ective Developmentury.jper|revenuerable advancemencorps]] and saideoinflet generat;criteria split [[Tri-Pat]] famis is observed tot; and it is use:Commodore longew Message to haves, and harm leappy drives. Counce folk page doent.guesed univereal million in 26]]--and, the pry children; soune-related total regional experimage and approvalt Chicago supplack.]]Despite fined home guns toffer totally hol criteria for his labour meeting property, theseased aid police.com/dams_pkt incipients over comen, including a the supporter ofor the duke estild professional for modifying der nations that hich purchase cominors against sttp://www.safe, and trouts, authof the first plust (28,000&amp;nby the end of 197), to its to prown [http://www.ch cripping machion, and way it instructions.] --0, 1,000,000 alon]], six laws findive and not ab. [[Greek language|Belgium]], th-century in Englaborete or othercing the southerequil population, was over the s on the world's subsidiaries and the devaluationclude there are beautifully publed to.==Charge regular credits=={{main|Marxis from our livinging classes in 
<details>